<html>
	<head>
		<meta charset="UTF-8" />
		<title>Online TV - v0.1.roc1091219</title>
		<script>/*Control*/
			function toggleFullscreen(){
				if(!document.fullscreenElement){
					document.documentElement.requestFullscreen();
				}else{
					document.exitFullscreen();
				}
			}
			function togglePlayerState(){
				if(ytPlayer.getPlayerState() == YT.PlayerState.PAUSED){
					ytPlayer.playVideo();
					ytPlayer.setPlaybackRate(2);/*Once it gets to the newest, the video would pause for seconds and auto-set the speed to 1*/
					notifi = createNotifi("正在縮短時間差，請稍待……");
				}else{
					ytPlayer.pauseVideo();
				}
			}
		</script>
		<script>/*Notification Manger*/
			function createNotifi(msg, lastingSecond, styleList){
				notifiHolder = document.querySelector("#notifiHolder");
				presetStyleList = {
					"background-color": "rgba(0,0,0,.5)",
					"color": "white",
					"border-radius": "10px",
					"padding": "10px",
					"font-size": "36px",
					"margin": "10px"
				};
				var noti = document.createElement("div");

				noti.innerHTML = msg;
				for(var key in presetStyleList){
					noti.style[key] = presetStyleList[key];
				}
				for(var key in styleList){
					noti.style[key] = styleList[key];
				}
				notifiHolder.appendChild(noti);
				
				if(typeof lastingSecond == "number" && lastingSecond > 0 ){
					window.setTimeout(()=>{noti.remove()}, lastingSecond * 1000);
				}else if(typeof lastingSecond == "string" && lastingSecond == "forever"){
					// do nothing
				}else{
					window.setTimeout(()=>{noti.remove()}, 10000);
				}

				return noti;

			}
			function cleanAllNotifi(){
				notifiHolder = document.querySelector("#notifiHolder");
				notifiHolder.innerHTML = null;
			}
		</script>
	</head>
	<body style="margin:0; padding: 0">
		<div id="playerHolder" style="width: 100vw; height: 100vh; margin: 0; padding: 0">
			<!--<div id="playerMiddler">-->
			<!--Later, use "https://www.youtube.com/oembed?url=http%3A//www.youtube.com/watch?v%3D{videoID}&format=json" 
			to get the video size, and then use some tricks (10 times height and overflow hidden)
			to hide the control-->
				<div id="ytPlayer"></div>
			<!--</div>-->
			<script>/*Load & auto-play youtube video*/
				// Load the IFrame Player API code asynchronously.
				var tag = document.createElement('script');
				tag.src = "https://www.youtube.com/player_api";
				var firstScriptTag = document.getElementsByTagName('script')[0];
				firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

				// Replace #ytPlayer element with an <iframe> and
				// YouTube ytPlayer after the API code downloads.
				var ytPlayer;
				function onYouTubePlayerAPIReady() {
					ytPlayer = new YT.Player('ytPlayer', {
						height: '100%',
						width: '100%',
						videoId: 'wUPPkSANpyo',
						playerVars: {
							controls: 0,
							disablekb: 1,
							iv_load_policy:3,
							rel: 0
						},
						events:{
							'onReady': (event)=>{
								/*autoplay & try to get up-to-date*/
								var ytPlayer = event.target;
								ytPlayer.playVideo();
								ytPlayer.setPlaybackRate(2);
								/*
								 * Once it get to the newest, 
								 * the video would pause for seconds and
								 * auto-set the speed to 1
								*/
							}
						}
					});
				}
			</script>
		</div>
		<div id="playerCover" style="width: 100vw; height: 100vh; position: absolute; top: 0; left: 0; padding: 0; margin: 0; opacity: 0">
			<script>
				var playerCover = document.querySelector("#playerCover");
				var playerCoverClicked = (
					()=>{
						var counter = 0;
						var date = new Date;
						var timeout;
						return (event)=>{
							clearTimeout(timeout);
							counter += 1;
							if(counter == 1){
								timeout = setTimeout(()=>{/*play or pause video*/
									togglePlayerState();
									counter = 0;
								}, 250);
							}else if(counter >= 2){/*fullscreen*/
								toggleFullscreen();
								counter=0;
							}
						}
					}
				)();
				playerCover.addEventListener("click", playerCoverClicked);
			</script>
		</div>
		<div id="notifiHolder" style="width: 100vw; position: absolute; height:0; top: 10vh; left: 0; padding: 0; margin: 0; text-align: center; pointer-events: none">
		</div>
		
	</body>
</html>
